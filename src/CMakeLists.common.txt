set(CMAKE_CXX_FLAGS "-Wall")

ADD_EXECUTABLE(track-features
  track_features.cpp
  read_image.cpp
  klt_tracker.cpp
  image_point_writer)
TARGET_LINK_LIBRARIES(track-features glog gflags)
TARGET_LINK_LIBRARIES(track-features ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(track-features klt)

ADD_EXECUTABLE(track-features-bidirectional
  track_features_bidirectional.cpp
  read_image.cpp
  klt_tracker.cpp
  image_point_writer.cpp)
TARGET_LINK_LIBRARIES(track-features-bidirectional glog gflags)
TARGET_LINK_LIBRARIES(track-features-bidirectional ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(track-features-bidirectional klt)

ADD_EXECUTABLE(visualize-tracks
  visualize_tracks.cpp
  read_image.cpp
  random_color.cpp
  image_point_reader.cpp)
TARGET_LINK_LIBRARIES(visualize-tracks glog gflags)
TARGET_LINK_LIBRARIES(visualize-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(visualize-all-tracks
  visualize_all_tracks.cpp
  read_image.cpp
  random_color.cpp
  image_point_reader.cpp)
TARGET_LINK_LIBRARIES(visualize-all-tracks glog gflags)
TARGET_LINK_LIBRARIES(visualize-all-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(visualize-keypoints
  visualize_keypoints.cpp
  read_image.cpp
  rigid_feature.cpp
  rigid_feature_reader.cpp
  rigid_warp.cpp
  random_color.cpp)
TARGET_LINK_LIBRARIES(visualize-keypoints glog gflags)
TARGET_LINK_LIBRARIES(visualize-keypoints ${OpenCV_LIBS})

ADD_EXECUTABLE(match-features
  match_features.cpp
  descriptor_reader.cpp)
TARGET_LINK_LIBRARIES(match-features glog gflags)
TARGET_LINK_LIBRARIES(match-features ${OpenCV_LIBS})

ADD_EXECUTABLE(visualize-matches
  visualize_matches.cpp
  read_image.cpp
  draw_matches.cpp
  rigid_feature.cpp
  rigid_warp.cpp
  random_color.cpp
  match_reader.cpp
  rigid_feature_reader.cpp)
TARGET_LINK_LIBRARIES(visualize-matches glog gflags)
TARGET_LINK_LIBRARIES(visualize-matches ${OpenCV_LIBS})

ADD_EXECUTABLE(adjacent-matches-to-tracks
  adjacent_matches_to_tracks.cpp
  read_image.cpp
  match_reader.cpp
  rigid_feature.cpp
  rigid_feature_reader.cpp
  rigid_feature_writer.cpp)
TARGET_LINK_LIBRARIES(adjacent-matches-to-tracks glog gflags)
TARGET_LINK_LIBRARIES(adjacent-matches-to-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(track-rigid
  track_rigid.cpp
  read_image.cpp
  flow.cpp
  rigid_warp.cpp
  rigid_feature.cpp
  random_color.cpp)
TARGET_LINK_LIBRARIES(track-rigid glog gflags)
TARGET_LINK_LIBRARIES(track-rigid ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(track-rigid ceres)
TARGET_LINK_LIBRARIES(track-rigid cxsparse)
TARGET_LINK_LIBRARIES(track-rigid cholmod ccolamd camd colamd amd)
TARGET_LINK_LIBRARIES(track-rigid ${LAPACK_LIB})

ADD_EXECUTABLE(track-rigid-bidir
  track_rigid_bidir.cpp
  read_image.cpp
  flow.cpp
  rigid_warp.cpp
  rigid_feature.cpp
  rigid_feature_reader.cpp
  rigid_feature_writer.cpp
  random_color.cpp)
TARGET_LINK_LIBRARIES(track-rigid-bidir glog gflags)
TARGET_LINK_LIBRARIES(track-rigid-bidir ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(track-rigid-bidir ceres)
TARGET_LINK_LIBRARIES(track-rigid-bidir cxsparse)
TARGET_LINK_LIBRARIES(track-rigid-bidir cholmod ccolamd camd colamd amd)
TARGET_LINK_LIBRARIES(track-rigid-bidir ${LAPACK_LIB})

ADD_EXECUTABLE(extract-sift-tracks
  extract_sift_tracks.cpp
  read_image.cpp
  rigid_feature.cpp
  rigid_warp.cpp
  sift.cpp
  rigid_feature_reader.cpp
  rigid_feature_writer.cpp
  descriptor_writer.cpp)
TARGET_LINK_LIBRARIES(extract-sift-tracks glog gflags)
TARGET_LINK_LIBRARIES(extract-sift-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(test-extract-sift
  test_extract_sift.cpp
  read_image.cpp
  rigid_feature.cpp
  rigid_warp.cpp
  sift.cpp)
TARGET_LINK_LIBRARIES(test-extract-sift glog gflags)
TARGET_LINK_LIBRARIES(test-extract-sift ${OpenCV_LIBS})

ADD_EXECUTABLE(pca-descriptor
  pca_descriptor.cpp
  random_color.cpp
  descriptor_reader.cpp)
TARGET_LINK_LIBRARIES(pca-descriptor glog gflags)
TARGET_LINK_LIBRARIES(pca-descriptor ${OpenCV_LIBS})

ADD_EXECUTABLE(visualize-rigid-tracks
  visualize_rigid_tracks.cpp
  rigid_feature.cpp
  rigid_warp.cpp
  read_image.cpp
  random_color.cpp
  rigid_feature_reader.cpp)
TARGET_LINK_LIBRARIES(visualize-rigid-tracks glog gflags)
TARGET_LINK_LIBRARIES(visualize-rigid-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(track-rigid-test
  track_rigid_test.cpp
  read_image.cpp
  flow.cpp
  rigid_warp.cpp
  rigid_feature.cpp
  random_color.cpp)
TARGET_LINK_LIBRARIES(track-rigid-test glog gflags)
TARGET_LINK_LIBRARIES(track-rigid-test ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(track-rigid-test ceres)
TARGET_LINK_LIBRARIES(track-rigid-test cxsparse)
TARGET_LINK_LIBRARIES(track-rigid-test cholmod ccolamd camd colamd amd)
TARGET_LINK_LIBRARIES(track-rigid-test ${LAPACK_LIB})

ADD_EXECUTABLE(merge-rigid-tracks
  merge_rigid_tracks.cpp
  rigid_feature.cpp
  rigid_feature_reader.cpp
  rigid_feature_writer.cpp)
TARGET_LINK_LIBRARIES(merge-rigid-tracks glog gflags)
TARGET_LINK_LIBRARIES(merge-rigid-tracks ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(merge-rigid-tracks ceres)
TARGET_LINK_LIBRARIES(merge-rigid-tracks cxsparse)
TARGET_LINK_LIBRARIES(merge-rigid-tracks cholmod ccolamd camd colamd amd)
TARGET_LINK_LIBRARIES(merge-rigid-tracks ${LAPACK_LIB})

ADD_EXECUTABLE(select-active-tracks
  select_active_tracks.cpp
  rigid_feature.cpp
  rigid_feature_reader.cpp
  rigid_feature_writer.cpp)
TARGET_LINK_LIBRARIES(select-active-tracks glog gflags)
TARGET_LINK_LIBRARIES(select-active-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(effect-of-sift-threshold
  effect_of_sift_threshold.cpp
  descriptor_reader.cpp)
TARGET_LINK_LIBRARIES(effect-of-sift-threshold glog gflags)
TARGET_LINK_LIBRARIES(effect-of-sift-threshold ${OpenCV_LIBS})

ADD_EXECUTABLE(find-keypoints-and-extract-descriptors
  find_keypoints_and_extract_descriptors.cpp
  read_image.cpp
  rigid_feature.cpp
  rigid_warp.cpp
  sift.cpp
  rigid_feature_writer.cpp
  descriptor_writer.cpp)
TARGET_LINK_LIBRARIES(find-keypoints-and-extract-descriptors glog gflags)
TARGET_LINK_LIBRARIES(find-keypoints-and-extract-descriptors ${OpenCV_LIBS})

ADD_EXECUTABLE(optimal-triangulation-test
    optimal_triangulation_test.cpp
    optimal_triangulation.cpp
    roots.cpp
    geometry.cpp)
TARGET_LINK_LIBRARIES(optimal-triangulation-test glog gflags)
TARGET_LINK_LIBRARIES(optimal-triangulation-test ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(optimal-triangulation-test gsl ${LAPACK_LIB})

ADD_EXECUTABLE(evaluate-matches
    evaluate_matches.cpp
    match_reader.cpp
    matrix_reader.cpp
    image_point_reader.cpp
    number_writer.cpp
    optimal_triangulation.cpp
    roots.cpp)
TARGET_LINK_LIBRARIES(evaluate-matches glog gflags)
TARGET_LINK_LIBRARIES(evaluate-matches ${OpenCV_LIBS})
TARGET_LINK_LIBRARIES(evaluate-matches gsl ${LAPACK_LIB})

ADD_EXECUTABLE(undistort-image
    undistort_image.cpp
    camera_properties.cpp
    camera_properties_reader.cpp
    distortion.cpp
    read_image.cpp)
TARGET_LINK_LIBRARIES(undistort-image glog gflags)
TARGET_LINK_LIBRARIES(undistort-image ${OpenCV_LIBS})

ADD_EXECUTABLE(undistort-points
    undistort_points.cpp
    image_point_reader.cpp
    image_point_writer.cpp
    camera_properties.cpp
    camera_properties_reader.cpp
    distortion.cpp)
TARGET_LINK_LIBRARIES(undistort-points glog gflags)
TARGET_LINK_LIBRARIES(undistort-points ${OpenCV_LIBS})

ADD_EXECUTABLE(cameras-to-fund-mat
    cameras_to_fund_mat.cpp
    camera_pose.cpp
    camera_pose_reader.cpp
    world_point_reader.cpp
    camera_properties.cpp
    camera_properties_reader.cpp
    geometry.cpp
    matrix_writer.cpp)
TARGET_LINK_LIBRARIES(cameras-to-fund-mat glog gflags)
TARGET_LINK_LIBRARIES(cameras-to-fund-mat ${OpenCV_LIBS})

ADD_EXECUTABLE(effect-of-matching-parameters
  effect_of_matching_parameters.cpp
  read_lines.cpp
  number_reader.cpp
  stats.cpp)
TARGET_LINK_LIBRARIES(effect-of-matching-parameters glog gflags)
TARGET_LINK_LIBRARIES(effect-of-matching-parameters ${OpenCV_LIBS})

ADD_EXECUTABLE(select-long-tracks
  select_long_tracks.cpp
  rigid_feature.cpp
  rigid_feature_reader.cpp
  rigid_feature_writer.cpp)
TARGET_LINK_LIBRARIES(select-long-tracks glog gflags)
TARGET_LINK_LIBRARIES(select-long-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(match-tracks-using-mean
  match_tracks_using_mean.cpp
  descriptor_reader.cpp)
TARGET_LINK_LIBRARIES(match-tracks-using-mean glog gflags)
TARGET_LINK_LIBRARIES(match-tracks-using-mean ${OpenCV_LIBS})

ADD_EXECUTABLE(exhaustive-matches-to-tracks
  exhaustive_matches_to_tracks.cpp
  read_lines.cpp
  match_reader.cpp
  multiview_track.cpp)
TARGET_LINK_LIBRARIES(exhaustive-matches-to-tracks glog gflags)
TARGET_LINK_LIBRARIES(exhaustive-matches-to-tracks ${OpenCV_LIBS})

ADD_EXECUTABLE(visualize-multiview-tracks
  visualize_multiview_tracks.cpp
  read_lines.cpp
  multiview_track.cpp)
TARGET_LINK_LIBRARIES(visualize-multiview-tracks glog gflags)
TARGET_LINK_LIBRARIES(visualize-multiview-tracks ${OpenCV_LIBS})
